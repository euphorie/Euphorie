{"version":3,"file":"chunks/4334.34c1cf0552f2a01e9f4c.min.js","mappings":"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","sources":["webpack://oira.prototype/./node_modules/prosemirror-gapcursor/dist/index.es.js","webpack://oira.prototype/./node_modules/@tiptap/extension-gapcursor/dist/tiptap-extension-gapcursor.esm.js"],"sourcesContent":["import { keydownHandler } from 'prosemirror-keymap';\nimport { NodeSelection, Selection, Plugin, TextSelection } from 'prosemirror-state';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\nimport { Slice } from 'prosemirror-model';\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nvar GapCursor = /*@__PURE__*/(function (Selection) {\n  function GapCursor($pos) {\n    Selection.call(this, $pos, $pos);\n  }\n\n  if ( Selection ) GapCursor.__proto__ = Selection;\n  GapCursor.prototype = Object.create( Selection && Selection.prototype );\n  GapCursor.prototype.constructor = GapCursor;\n\n  GapCursor.prototype.map = function map (doc, mapping) {\n    var $pos = doc.resolve(mapping.map(this.head));\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  };\n\n  GapCursor.prototype.content = function content () { return Slice.empty };\n\n  GapCursor.prototype.eq = function eq (other) {\n    return other instanceof GapCursor && other.head == this.head\n  };\n\n  GapCursor.prototype.toJSON = function toJSON () {\n    return {type: \"gapcursor\", pos: this.head}\n  };\n\n  GapCursor.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.pos != \"number\") { throw new RangeError(\"Invalid input for GapCursor.fromJSON\") }\n    return new GapCursor(doc.resolve(json.pos))\n  };\n\n  GapCursor.prototype.getBookmark = function getBookmark () { return new GapBookmark(this.anchor) };\n\n  GapCursor.valid = function valid ($pos) {\n    var parent = $pos.parent;\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) { return false }\n    var override = parent.type.spec.allowGapCursor;\n    if (override != null) { return override }\n    var deflt = parent.contentMatchAt($pos.index()).defaultType;\n    return deflt && deflt.isTextblock\n  };\n\n  GapCursor.findFrom = function findFrom ($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) { return $pos }\n      var pos = $pos.pos, next = null;\n      // Scan up from this position\n      for (var d = $pos.depth;; d--) {\n        var parent = $pos.node(d);\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1);\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir;\n        var $cur = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur)) { return $cur }\n      }\n\n      // And then down into the next node\n      for (;;) {\n        var inside = dir > 0 ? next.firstChild : next.lastChild;\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir);\n            mustMove = false;\n            continue search\n          }\n          break\n        }\n        next = inside;\n        pos += dir;\n        var $cur$1 = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur$1)) { return $cur$1 }\n      }\n\n      return null\n    }\n  };\n\n  return GapCursor;\n}(Selection));\n\nGapCursor.prototype.visible = false;\n\nSelection.jsonID(\"gapcursor\", GapCursor);\n\nvar GapBookmark = function GapBookmark(pos) {\n  this.pos = pos;\n};\nGapBookmark.prototype.map = function map (mapping) {\n  return new GapBookmark(mapping.map(this.pos))\n};\nGapBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.pos);\n  return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n};\n\nfunction closedBefore($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.index(d), parent = $pos.node(d);\n    // At the start of this parent, look at next one\n    if (index == 0) {\n      if (parent.type.spec.isolating) { return true }\n      continue\n    }\n    // See if the node before (or its first ancestor) is closed\n    for (var before = parent.child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) { return true }\n      if (before.inlineContent) { return false }\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.indexAfter(d), parent = $pos.node(d);\n    if (index == parent.childCount) {\n      if (parent.type.spec.isolating) { return true }\n      continue\n    }\n    for (var after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) { return true }\n      if (after.inlineContent) { return false }\n    }\n  }\n  return true\n}\n\n// :: () â†’ Plugin\n// Create a gap cursor plugin. When enabled, this will capture clicks\n// near and arrow-key-motion past places that don't have a normally\n// selectable position nearby, and create a gap cursor selection for\n// them. The cursor is drawn as an element with class\n// `ProseMirror-gapcursor`. You can either include\n// `style/gapcursor.css` from the package's directory or add your own\n// styles to make it visible.\nvar gapCursor = function() {\n  return new Plugin({\n    props: {\n      decorations: drawGapCursor,\n\n      createSelectionBetween: function createSelectionBetween(_view, $anchor, $head) {\n        if ($anchor.pos == $head.pos && GapCursor.valid($head)) { return new GapCursor($head) }\n      },\n\n      handleClick: handleClick,\n      handleKeyDown: handleKeyDown\n    }\n  })\n};\n\nvar handleKeyDown = keydownHandler({\n  \"ArrowLeft\": arrow(\"horiz\", -1),\n  \"ArrowRight\": arrow(\"horiz\", 1),\n  \"ArrowUp\": arrow(\"vert\", -1),\n  \"ArrowDown\": arrow(\"vert\", 1)\n});\n\nfunction arrow(axis, dir) {\n  var dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\");\n  return function(state, dispatch, view) {\n    var sel = state.selection;\n    var $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty;\n    if (sel instanceof TextSelection) {\n      if (!view.endOfTextblock(dirStr) || $start.depth == 0) { return false }\n      mustMove = false;\n      $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before());\n    }\n    var $found = GapCursor.findFrom($start, dir, mustMove);\n    if (!$found) { return false }\n    if (dispatch) { dispatch(state.tr.setSelection(new GapCursor($found))); }\n    return true\n  }\n}\n\nfunction handleClick(view, pos, event) {\n  if (!view.editable) { return false }\n  var $pos = view.state.doc.resolve(pos);\n  if (!GapCursor.valid($pos)) { return false }\n  var ref = view.posAtCoords({left: event.clientX, top: event.clientY});\n  var inside = ref.inside;\n  if (inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(inside))) { return false }\n  view.dispatch(view.state.tr.setSelection(new GapCursor($pos)));\n  return true\n}\n\nfunction drawGapCursor(state) {\n  if (!(state.selection instanceof GapCursor)) { return null }\n  var node = document.createElement(\"div\");\n  node.className = \"ProseMirror-gapcursor\";\n  return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, {key: \"gapcursor\"})])\n}\n\nexport { GapCursor, gapCursor };\n//# sourceMappingURL=index.es.js.map\n","import { Extension, callOrReturn, getExtensionField } from '@tiptap/core';\nimport { gapCursor } from 'prosemirror-gapcursor';\n\nconst Gapcursor = Extension.create({\r\n    name: 'gapCursor',\r\n    addProseMirrorPlugins() {\r\n        return [\r\n            gapCursor(),\r\n        ];\r\n    },\r\n    extendNodeSchema(extension) {\r\n        var _a;\r\n        const context = {\r\n            name: extension.name,\r\n            options: extension.options,\r\n            storage: extension.storage,\r\n        };\r\n        return {\r\n            allowGapCursor: (_a = callOrReturn(getExtensionField(extension, 'allowGapCursor', context))) !== null && _a !== void 0 ? _a : null,\r\n        };\r\n    },\r\n});\n\nexport { Gapcursor, Gapcursor as default };\n//# sourceMappingURL=tiptap-extension-gapcursor.esm.js.map\n"],"names":["GapCursor","Selection","$pos","call","this","__proto__","prototype","Object","create","constructor","map","doc","mapping","resolve","head","valid","near","content","eq","other","toJSON","type","pos","fromJSON","json","RangeError","getBookmark","GapBookmark","anchor","parent","isTextblock","d","depth","index","node","before","child","lastChild","childCount","inlineContent","isAtom","spec","isolating","closedBefore","indexAfter","after","firstChild","closedAfter","override","allowGapCursor","deflt","contentMatchAt","defaultType","findFrom","dir","mustMove","search","next","$cur","inside","isText","nodeSize","$cur$1","visible","handleKeyDown","arrow","axis","dirStr","state","dispatch","view","sel","selection","$start","$to","$from","empty","endOfTextblock","$found","tr","setSelection","handleClick","event","editable","posAtCoords","left","clientX","top","clientY","nodeAt","drawGapCursor","document","createElement","className","key","Gapcursor","Extension","name","addProseMirrorPlugins","props","decorations","createSelectionBetween","_view","$anchor","$head","extendNodeSchema","extension","_a","context","options","storage","callOrReturn","getExtensionField"],"sourceRoot":""}