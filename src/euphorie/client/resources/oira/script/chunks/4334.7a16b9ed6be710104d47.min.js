"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[4334],{34334:function(e,r,t){t.r(r),t.d(r,{Gapcursor:function(){return v},default:function(){return v}});var n=t(26798),o=t(32629),i=t(76922),a=t(98780),u=t(38638),s=function(e){function r(r){e.call(this,r,r)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.map=function(t,n){var o=t.resolve(n.map(this.head));return r.valid(o)?new r(o):e.near(o)},r.prototype.content=function(){return u.p2.empty},r.prototype.eq=function(e){return e instanceof r&&e.head==this.head},r.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},r.fromJSON=function(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new r(e.resolve(t.pos))},r.prototype.getBookmark=function(){return new l(this.anchor)},r.valid=function(e){var r=e.parent;if(r.isTextblock||!function(e){for(var r=e.depth;r>=0;r--){var t=e.index(r);if(0!=t)for(var n=e.node(r).child(t-1);;n=n.lastChild){if(0==n.childCount&&!n.inlineContent||n.isAtom||n.type.spec.isolating)return!0;if(n.inlineContent)return!1}}return!0}(e)||!function(e){for(var r=e.depth;r>=0;r--){var t=e.indexAfter(r),n=e.node(r);if(t!=n.childCount)for(var o=n.child(t);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(e))return!1;var t=r.type.spec.allowGapCursor;if(null!=t)return t;var n=r.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock},r.findFrom=function(e,t,n){e:for(;;){if(!n&&r.valid(e))return e;for(var o=e.pos,a=null,u=e.depth;;u--){var s=e.node(u);if(t>0?e.indexAfter(u)<s.childCount:e.index(u)>0){a=s.child(t>0?e.indexAfter(u):e.index(u)-1);break}if(0==u)return null;o+=t;var l=e.doc.resolve(o);if(r.valid(l))return l}for(;;){var c=t>0?a.firstChild:a.lastChild;if(!c){if(a.isAtom&&!a.isText&&!i.qv.isSelectable(a)){e=e.doc.resolve(o+a.nodeSize*t),n=!1;continue e}break}a=c,o+=t;var p=e.doc.resolve(o);if(r.valid(p))return p}return null}},r}(i.Y1);s.prototype.visible=!1,i.Y1.jsonID("gapcursor",s);var l=function(e){this.pos=e};l.prototype.map=function(e){return new l(e.map(this.pos))},l.prototype.resolve=function(e){var r=e.resolve(this.pos);return s.valid(r)?new s(r):i.Y1.near(r)};var c=(0,o.$)({ArrowLeft:p("horiz",-1),ArrowRight:p("horiz",1),ArrowUp:p("vert",-1),ArrowDown:p("vert",1)});function p(e,r){var t="vert"==e?r>0?"down":"up":r>0?"right":"left";return function(e,n,o){var a=e.selection,u=r>0?a.$to:a.$from,l=a.empty;if(a instanceof i.Bs){if(!o.endOfTextblock(t)||0==u.depth)return!1;l=!1,u=e.doc.resolve(r>0?u.after():u.before())}var c=s.findFrom(u,r,l);return!!c&&(n&&n(e.tr.setSelection(new s(c))),!0)}}function f(e,r,t){if(!e.editable)return!1;var n=e.state.doc.resolve(r);if(!s.valid(n))return!1;var o=e.posAtCoords({left:t.clientX,top:t.clientY}).inside;return!(o>-1&&i.qv.isSelectable(e.state.doc.nodeAt(o)))&&(e.dispatch(e.state.tr.setSelection(new s(n))),!0)}function d(e){if(!(e.selection instanceof s))return null;var r=document.createElement("div");return r.className="ProseMirror-gapcursor",a.EH.create(e.doc,[a.p.widget(e.selection.head,r,{key:"gapcursor"})])}const v=n.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new i.Sy({props:{decorations:d,createSelectionBetween:function(e,r,t){if(r.pos==t.pos&&s.valid(t))return new s(t)},handleClick:f,handleKeyDown:c}})],extendNodeSchema(e){var r;const t={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!==(r=(0,n.callOrReturn)((0,n.getExtensionField)(e,"allowGapCursor",t)))&&void 0!==r?r:null}}})}}]);