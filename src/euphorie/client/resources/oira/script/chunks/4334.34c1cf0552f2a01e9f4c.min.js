"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[4334],{34334:function(e,r,t){t.r(r),t.d(r,{Gapcursor:function(){return v},default:function(){return v}});var n=t(26798),o=t(32629),i=t(76922),a=t(98780),s=t(38638),l=function(e){function r(r){e.call(this,r,r)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.map=function(t,n){var o=t.resolve(n.map(this.head));return r.valid(o)?new r(o):e.near(o)},r.prototype.content=function(){return s.p2.empty},r.prototype.eq=function(e){return e instanceof r&&e.head==this.head},r.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},r.fromJSON=function(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new r(e.resolve(t.pos))},r.prototype.getBookmark=function(){return new u(this.anchor)},r.valid=function(e){var r=e.parent;if(r.isTextblock||!function(e){for(var r=e.depth;r>=0;r--){var t=e.index(r),n=e.node(r);if(0!=t)for(var o=n.child(t-1);;o=o.lastChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e)||!function(e){for(var r=e.depth;r>=0;r--){var t=e.indexAfter(r),n=e.node(r);if(t!=n.childCount)for(var o=n.child(t);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e))return!1;var t=r.type.spec.allowGapCursor;if(null!=t)return t;var n=r.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock},r.findFrom=function(e,t,n){e:for(;;){if(!n&&r.valid(e))return e;for(var o=e.pos,a=null,s=e.depth;;s--){var l=e.node(s);if(t>0?e.indexAfter(s)<l.childCount:e.index(s)>0){a=l.child(t>0?e.indexAfter(s):e.index(s)-1);break}if(0==s)return null;o+=t;var u=e.doc.resolve(o);if(r.valid(u))return u}for(;;){var c=t>0?a.firstChild:a.lastChild;if(!c){if(a.isAtom&&!a.isText&&!i.qv.isSelectable(a)){e=e.doc.resolve(o+a.nodeSize*t),n=!1;continue e}break}a=c,o+=t;var p=e.doc.resolve(o);if(r.valid(p))return p}return null}},r}(i.Y1);l.prototype.visible=!1,i.Y1.jsonID("gapcursor",l);var u=function(e){this.pos=e};u.prototype.map=function(e){return new u(e.map(this.pos))},u.prototype.resolve=function(e){var r=e.resolve(this.pos);return l.valid(r)?new l(r):i.Y1.near(r)};var c=(0,o.$)({ArrowLeft:p("horiz",-1),ArrowRight:p("horiz",1),ArrowUp:p("vert",-1),ArrowDown:p("vert",1)});function p(e,r){var t="vert"==e?r>0?"down":"up":r>0?"right":"left";return function(e,n,o){var a=e.selection,s=r>0?a.$to:a.$from,u=a.empty;if(a instanceof i.Bs){if(!o.endOfTextblock(t)||0==s.depth)return!1;u=!1,s=e.doc.resolve(r>0?s.after():s.before())}var c=l.findFrom(s,r,u);return!!c&&(n&&n(e.tr.setSelection(new l(c))),!0)}}function f(e,r,t){if(!e.editable)return!1;var n=e.state.doc.resolve(r);if(!l.valid(n))return!1;var o=e.posAtCoords({left:t.clientX,top:t.clientY}).inside;return!(o>-1&&i.qv.isSelectable(e.state.doc.nodeAt(o)))&&(e.dispatch(e.state.tr.setSelection(new l(n))),!0)}function d(e){if(!(e.selection instanceof l))return null;var r=document.createElement("div");return r.className="ProseMirror-gapcursor",a.EH.create(e.doc,[a.p.widget(e.selection.head,r,{key:"gapcursor"})])}const v=n.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new i.Sy({props:{decorations:d,createSelectionBetween:function(e,r,t){if(r.pos==t.pos&&l.valid(t))return new l(t)},handleClick:f,handleKeyDown:c}})],extendNodeSchema(e){var r;const t={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!==(r=(0,n.callOrReturn)((0,n.getExtensionField)(e,"allowGapCursor",t)))&&void 0!==r?r:null}}})}}]);
//# sourceMappingURL=4334.34c1cf0552f2a01e9f4c.min.js.map