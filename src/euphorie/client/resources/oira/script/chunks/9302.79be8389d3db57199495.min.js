"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[9302],{49302:function(t,e,o){o.r(e),o.d(e,{Dropcursor:function(){return l},default:function(){return l}});var i=o(26798),s=o(76922),r=o(21081);var n=function(t,e){var o=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var i=function(t){return o[e](t)};return t.dom.addEventListener(e,i),{name:e,handler:i}}))};n.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var o=e.name,i=e.handler;return t.editorView.dom.removeEventListener(o,i)}))},n.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},n.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},n.prototype.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var o=e.nodeBefore,i=e.nodeAfter;if(o||i){var s=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0)).getBoundingClientRect(),r=o?s.bottom:s.top;o&&i&&(r=(r+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:s.left,right:s.right,top:r-this.width/2,bottom:r+this.width/2}}}if(!t){var n=this.editorView.coordsAtPos(this.cursorPos);t={left:n.left-this.width/2,right:n.left+this.width/2,top:n.top,bottom:n.bottom}}var l,d,h=this.editorView.dom.offsetParent;if(this.element||(this.element=h.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!h||h==document.body&&"static"==getComputedStyle(h).position)l=-pageXOffset,d=-pageYOffset;else{var a=h.getBoundingClientRect();l=a.left-h.scrollLeft,d=a.top-h.scrollTop}this.element.style.left=t.left-l+"px",this.element.style.top=t.top-d+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},n.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},n.prototype.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),o=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),i=o&&o.type.spec.disableDropCursor,s="function"==typeof i?i(this.editorView,e):i;if(e&&!s){var n=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(n=(0,r.nj)(this.editorView.state.doc,n,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(n),this.scheduleRemoval(5e3)}}},n.prototype.dragend=function(){this.scheduleRemoval(20)},n.prototype.drop=function(){this.scheduleRemoval(20)},n.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};const l=i.Extension.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:null}),addProseMirrorPlugins(){return[(t=this.options,void 0===t&&(t={}),new s.Sy({view:function(e){return new n(e,t)}}))];var t}})}}]);