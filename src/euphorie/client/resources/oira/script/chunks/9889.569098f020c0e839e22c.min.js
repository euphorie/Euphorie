"use strict";(self.webpackChunkoira_prototype=self.webpackChunkoira_prototype||[]).push([[9889],{9889:function(e,t,a){a.r(t),a.d(t,{CodeBlock:function(){return i},backtickInputRegex:function(){return o},default:function(){return i},tildeInputRegex:function(){return s}});var r=a(26798),n=a(76922);const o=/^```(?<language>[a-z]*)?[\s\n]$/,s=/^~~~(?<language>[a-z]*)?[\s\n]$/,i=r.Node.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:a}=this.options,r=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter((e=>e.startsWith(a))).map((e=>e.replace(a,"")))[0];return r||null},renderHTML:e=>e.language?{class:this.options.languageClassPrefix+e.language}:null}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]},addCommands:()=>({setCodeBlock:e=>({commands:t})=>t.setNode("codeBlock",e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode("codeBlock","paragraph",e)}),addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,a=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!a&&t.parent.textContent.length)&&this.editor.commands.clearNodes())}}},addInputRules(){return[(0,r.textblockTypeInputRule)({find:o,type:this.type,getAttributes:({groups:e})=>e}),(0,r.textblockTypeInputRule)({find:s,type:this.type,getAttributes:({groups:e})=>e})]},addProseMirrorPlugins(){return[new n.Sy({key:new n.H$("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const a=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,s=null==o?void 0:o.mode;if(!a||!s)return!1;const{tr:i}=e.state;return i.replaceSelectionWith(this.type.create({language:s})),i.setSelection(n.Bs.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.insertText(a.replace(/\r\n?/g,"\n")),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}})}}]);