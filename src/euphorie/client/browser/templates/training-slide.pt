<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      meta:interpolation="true"
      tal:define="
        webhelpers nocall:context/@@webhelpers;
      "
      i18n:domain="euphorie"
>

<tal:data define="
    global counter python:1;
    slide_total_count python:10;
    training_view nocall:here/@@training_slide;
    slide view/slide_contents;
    ">

  <metal:slide define-macro="slide_content"
               meta:interpolation="true"
               i18n:domain="euphorie"
  >

            <tal:slide define="

                         slide_template slide/slide_template;
                         global counter python:counter+1;
                         content_item nocall:training_view/zodb_elem;
                         slide_type slide/slide_type;
                         description training_view/description;
                         image_urls training_view/image_urls;
                         measures slide/measures;
                         training_notes training_view/training_notes|nothing;
                       ">
              <div class="presentation-slide"
                   id="slide-${counter}"
              >
                <section class="mode-view slide-content ${slide_template} pat-auto-scale"
                         id="slide-content-${counter}"
                         data-pat-auto-scale="size: contain"
                >
                  <p class="toggle pat-switch"
                     data-pat-switch="selector: #slide-content-${counter}; add: mode-view; remove: mode-*"
                     i18n:translate=""
                  >Click to edit</p>
                  <section class="slide-body pat-rich pat-scroll-box">
                    <h1 class="slide-title">
                      <span class="slide-number">${training_view/number}
                      </span>
                        ${training_view/slide_title}
                    </h1>
                    <div class="slide-illustrations"
                         tal:condition="image_urls"
                    >
                      <figure class="illustration"
                              tal:repeat="image_url image_urls"
                      >
                        <a href="${image_url}">
                          <img src="${image_url}"
                               title=""
                          />
                        </a>
                      </figure>
                    </div>
                    <span tal:replace="structure python:webhelpers.get_safe_html(description)"></span>
                  </section>

                  <metal:footer define-macro="footer">
                    <footer class="slide-footer"
                            tal:define="
                              end python:counter==slide_total_count;
                            "
                    >
                      <p class="colofon">

                        <strong class="slide-number">${training_view/number}</strong>
                         |


            ${training_view/session/title} | ${training_view/slide_date} |
                        <tal:i18n i18n:translate="label_page">Page</tal:i18n>
                        ${counter}
                        <tal:i18n i18n:translate="label_page_of">of</tal:i18n>
                         ${slide_total_count}
                      </p>
                      <p class="controls">

                        <a class="pat-inject pat-button back slide-nav-prev"
                           href="${here/absolute_url}/@@training-slides#slide-${python:counter-1}"
                           data-pat-inject="target: #slide-0"
                        >Previous</a>


                        <a class="pat-inject default pat-button continue slide-nav-next"
                           href="${here/absolute_url}/@@training-slides#slide-${python:counter+1}"
                           data-pat-inject="target: #slide-0"
                           tal:condition="not: end"
                        >Next</a>
                        <tal:end condition="end">
                          <button class="default pat-button close-fullscreen"
                                  href="${here/absolute_url}/@@training#slide-0"
                                  name="close"
                                  type="button"
                                  tal:condition="not:question_intro_url"
                          >
            Close
                          </button>
                          <a class="pat-inject default pat-button continue slide-nav-next"
                             href="${question_intro_url}#slide-0"
                             data-pat-inject="target: #slide-0"
                             tal:condition="question_intro_url"
                          >Questions</a>
                        </tal:end>
                      </p>
                    </footer>
                  </metal:footer>
                </section>
              </div>
              <tal:measures condition="measures">
                <div class="presentation-slide concatenate template-measures"
                     id="slide-${counter}"
                     tal:define="
                       global counter python:counter+1;
                     "
                >
                  <section class="mode-view slide-content template-measures pat-auto-scale"
                           id="slide-content-${counter}"
                  >
                    <section class="slide-body pat-rich pat-scroll-box">
                      <h3 class="slide-subtitle">
                    ${training_view/heading_measures}
                      </h3>
                      <ul>
                        <tal:measures tal:repeat="measure_id measures">
                          <li tal:define="
                                measure_text python:measures[measure_id]['action'];
                              "
                              tal:condition="python:measures[measure_id]['active'] and measure_text"
                              tal:content="structure python:webhelpers.get_safe_html(measure_text)"
                          >measure</li>
                        </tal:measures>
                      </ul>
                    </section>
                    <metal:footer use-macro="training_view/macros/footer" />
                  </section>
                </div>
              </tal:measures>

              <tal:notes condition="training_notes">
                <div class="presentation-slide concatenate template-notes"
                     id="slide-${counter}"
                     tal:define="
                       global counter python:counter+1;
                     "
                >
                  <section class="mode-view slide-content template-measures pat-auto-scale"
                           id="slide-content-${counter}"
                  >
                    <section class="slide-body pat-rich pat-scroll-box">
                      <h3 class="card-subtitle"
                          i18n:translate="label_notes"
                      >
                    Notes
                      </h3>
                      <span tal:replace="structure python:webhelpers.get_safe_html(training_notes)"></span>
                    </section>
                    <metal:footer use-macro="training_view/macros/footer" />
                  </section>
                </div>
              </tal:notes>

            </tal:slide>


  </metal:slide>
</tal:data>
</html>
