<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      id="sessions"
      meta:interpolation="true"
      metal:use-macro="context/@@shell/macros/shell"
      tal:define="
        tools nocall:context/@@tools;
        webhelpers nocall:context/@@webhelpers;
      "
      i18n:domain="euphorie"
>
  <body>
    <metal:content fill-slot="content"
                tal:define="
                  language view/portal/plone_portal_state/language;
                  sessions view/sessions;
                  description context/description|string:;
                  introduction python:getattr(context, 'introduction', '') or '';
                "
    >
    <div id="content-pane">
      <tal:block replace="tile:statusmessages" />

      <article class="pat-rich">
        <h1 class="tool-name">${context/title}</h1>
        <section class="summary" tal:condition="python:description.strip()">
          <p tal:content="description"></p>
        </section>
      </article>

      <div tal:condition="sessions" class="risk-assessments ra-list">
        <h2 class="ra-list-title"
            i18n:translate="">Risk assessments made with this tool</h2>

              <ul class="ras">
                  <li tal:repeat="session sessions"
                      class="ra">
                    <a href="${here/absolute_url}/++session++${session/id}/@@start"
                      class="pat-inject follow"
                      data-pat-inject="source: #content; target: #content; && source: #osc; target: #osc; history: record"
                    >
                      <h4 class="name field">${session/title}</h4>
                      <p class="date field">
                        <span class="last-saved">
                          <tal:i18n i18n:translate="">Last saved</tal:i18n>
                          <time class="pat-display-time"
                              datetime="${value}"
                              data-pat-display-time="from-now: true; locale: ${language}"
                              tal:define="value session/modified/isoformat|nothing;"
                          >${value}</time>
                        </span>
                      </p>
                    </a>
                    <a class="publication-menu iconified icon-${python:session.published and 'published' or 'unpublished'} pat-tooltip"
                       tal:condition="webhelpers/use_publication_feature"
                       href="${here/absolute_url}/++session++${session/id}/@@publication_menu#publication-menu"
                       data-pat-tooltip="source: ajax; position-list: tr">Published <time class="  pat-display-time" data-pat-display-time="from-now: true" datetime="2018-03-28T08:00Z">2018-03-28</time></a>
                    <a class="more-menu iconified icon-ellipsis pat-tooltip inactive"
                       href="${here/absolute_url}/++session++${session/id}/@@more_menu#more-menu"
                       data-pat-tooltip="source: ajax; position-list: tr"
                       i18n:translate=""
                    >More</a>
                  </li>
              </ul>
      </div>

      <p class="button-bar">
        <a id="button-new-session"
           class="pat-button pat-inject"
           href="${here/absolute_url}/@@new-session.html?action=new"
           i18n:translate="button_start_new_session"
        >Start a new session with this tool</a>
      </p>

      <article class="pat-rich" tal:condition="python:introduction.strip()">
        <section class="introduction">
          <p tal:replace="structure introduction"></p>
        </section>
      </article>

    </div>
    </metal:content>

    <metal:splash fill-slot="splash_message_slot">
      <div class="splash-message" id="splash-message"
           tal:condition="python:splash_message is not None"
      >
        <hr class="trigger pat-switch"
            data-pat-switch="selector: body; remove: splash-on-motd*; add: splash-off-${splash_message/id}; store: local"
        />
        <article class="pat-rich content">
          <p>
            <img src="${base_url}/++resource++euphorie.media/oira-logo-colour.svg"
                 width="20%"
            />
          </p>
          <h1 tal:content="structure splash_message/title">Message of the day!</h1>
          <tal:content content="structure splash_message/text" />
        </article>
      </div>
    </metal:splash>

  <metal:slot fill-slot="aside-header">
    <header id="osc-header">
    </header>
  </metal:slot>

  <metal:slot fill-slot="aside-navigator">
    <div id="navigation">
    </div>
  </metal:slot>

  </body>
</html>
