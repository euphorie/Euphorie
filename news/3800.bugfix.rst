PPT and training generation is more resilient

Fixes an issue for archived sessions when the survey is republished with a removed risk.
